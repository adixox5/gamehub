<!DOCTYPE html>
<html lang="pl" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameHub - Strona Główna</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <link rel="stylesheet" th:href="@{/style/style.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>

<nav th:replace="~{fragments :: navbar}"></nav>

<main class="container mt-4">

    <section class="featured-slider mb-5">
        <div id="featured-slider-container">
            <a th:href="@{/game(id=1)}" class="featured-slide" style="background-image: url('https://placehold.co/1100x400/007bff/fff?text=2048');">
                <span class="slide-play-btn"><i class="fas fa-play"></i> Graj</span>
            </a>
            <a th:href="@{/game(id=2)}" class="featured-slide" style="background-image: url('https://placehold.co/1100x400/e75e8d/fff?text=Clumsy+Bird');">
                <span class="slide-play-btn"><i class="fas fa-play"></i> Graj</span>
            </a>
            <a th:href="@{/game(id='mk')}" class="featured-slide" style="background-image: url('/games/mk/images/arenas/0/arena.png');">
                <span class="slide-play-btn"><i class="fas fa-play"></i> Graj w MK</span>
                <div class="slide-content">
                    <h3>Mortal Kombat</h3>
                </div>
            </a>
        </div>
    </section>

    <section class="search-bar-container mb-4">
        <div class="category-dropdown" id="category-dropdown" style="position: relative; display: inline-block;">
            <button id="category-dropdown-btn" class="btn btn-primary dropdown-toggle">
                <span th:text="${currentCategory != null} ? ${currentCategory} : 'Wszystkie Kategorie'">Kategorie</span>
            </button>

            <div class="dropdown-menu show" id="categoryContent" style="display: none; position: absolute; z-index: 1000;">
                <a class="dropdown-item" th:href="@{/}">Wszystkie Gry</a>

                <a class="dropdown-item"
                   th:each="cat : ${categories}"
                   th:href="@{/(category=${cat})}"
                   th:text="${cat}">
                    Nazwa Kategorii
                </a>
            </div>
        </div>

        <form id="search-form" class="search-form d-flex gap-2">
            <input type="text" id="search-input" class="form-control" placeholder="Wyszukaj grę">
            <button type="submit" class="btn btn-outline-secondary">
                <i class="fas fa-search"></i>
            </button>
        </form>
    </section>

    <section class="popular-games-section">
        <h2 class="mb-4">Dostępne Gry</h2>

        <div class="row">
            <div class="col-md-4 mb-4" th:each="game : ${games}">
                <div class="card h-100 shadow-sm">
                    <div style="height: 200px; overflow: hidden; display: flex; align-items: center; justify-content: center; background: #f0f0f0;">
                        <img th:src="@{${game.imageUrl}}" class="card-img-top" alt="Game Image" style="object-fit: cover; width: 100%; height: 100%;">
                    </div>

                    <div class="card-body text-center">
                        <h5 class="card-title" th:text="${game.title}">Tytuł gry</h5>

                        <span class="badge bg-secondary mb-2" th:text="${game.category}">Kategoria</span>

                        <p class="card-text small text-muted" th:text="${game.description}">Opis gry</p>

                        <a th:href="@{${game.gameUrl}}" class="btn btn-success mt-2">
                            <i class="fas fa-play"></i> Zagraj teraz
                        </a>
                    </div>
                </div>
            </div>

            <div class="col-12 text-center" th:if="${games.empty}">
                <div class="alert alert-info">
                    Brak gier w tej kategorii. <a th:href="@{/}" class="alert-link">Pokaż wszystkie</a>.
                </div>
            </div>
        </div>
    </section>

</main>

<footer th:replace="~{fragments :: footer}"></footer>

<script th:src="@{/js/main.js}" defer></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    document.getElementById('category-dropdown-btn').addEventListener('click', function() {
        var menu = document.getElementById('categoryContent');
        if (menu.style.display === "none" || menu.style.display === "") {
            menu.style.display = "block";
        } else {
            menu.style.display = "none";
        }
    });
</script>

</body>
</html>